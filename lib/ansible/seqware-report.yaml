---
- hosts: all-masters
  gather_facts: no
  sudo: yes
  sudo_user: seqware
  tasks:
#  - name: Ensure Hadoop is running
#    service: name=hadoop-hdfs-namenode state=started  
#  - name: Seqware Workflow Report
#    command: /home/seqware/bin/seqware workflow report --accession 2
#    register: report_result
#    tags: seqware
#  - debug: var=report_result.stdout_lines
#    tags: seqware
  - name: Seware Webservice Report
    shell: curl -u admin@admin.com:admin http://localhost:8080/SeqWareWebService/reports/workflows/2 > /home/seqware/bwa_run_report_{{ inventory_hostname }}.out
    tags: seqware
  - name: Download Reports
    fetch: src=/home/seqware/bwa_run_report_{{ inventory_hostname }}.out
           dest=/home/jiao/sergei/Bindle/reports/
           flat=yes
    tags: seqware
    
#  - set_fact:
#      wf_fact: "{{ wf_report.content|from_json}}"
#  - debug: var=wf_fact
